<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>
<head>
	<link name="NotoSans" type="font" subtype="truetype" src="${nsfont.NotoSans_Regular}" src-bold="${nsfont.NotoSans_Bold}" src-italic="${nsfont.NotoSans_Italic}" src-bolditalic="${nsfont.NotoSans_BoldItalic}" bytes="2" />
	<#if .locale == "zh_CN">
		<link name="NotoSansCJKsc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKsc_Regular}" src-bold="${nsfont.NotoSansCJKsc_Bold}" bytes="2" />
	<#elseif .locale == "zh_TW">
		<link name="NotoSansCJKtc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKtc_Regular}" src-bold="${nsfont.NotoSansCJKtc_Bold}" bytes="2" />
	<#elseif .locale == "ja_JP">
		<link name="NotoSansCJKjp" type="font" subtype="opentype" src="${nsfont.NotoSansCJKjp_Regular}" src-bold="${nsfont.NotoSansCJKjp_Bold}" bytes="2" />
	<#elseif .locale == "ko_KR">
		<link name="NotoSansCJKkr" type="font" subtype="opentype" src="${nsfont.NotoSansCJKkr_Regular}" src-bold="${nsfont.NotoSansCJKkr_Bold}" bytes="2" />
	<#elseif .locale == "th_TH">
		<link name="NotoSansThai" type="font" subtype="opentype" src="${nsfont.NotoSansThai_Regular}" src-bold="${nsfont.NotoSansThai_Bold}" bytes="2" />
	</#if>
    <macrolist>
        <macro id="nlheader">
<#-- Phone number formatting function -->
<#function formatPhone phone>
    <#if phone?has_content>
        <#assign cleanPhone = phone?replace("+", "")?replace("-", "")?replace(" ", "")?replace("(", "")?replace(")", "") />
        <#if cleanPhone?length == 11>
            <#return cleanPhone?substring(0,1) + "-" + cleanPhone?substring(1,4) + "-" + cleanPhone?substring(4,7) + "-" + cleanPhone?substring(7,11) />
        <#elseif cleanPhone?length == 10>
            <#return cleanPhone?substring(0,3) + "-" + cleanPhone?substring(3,6) + "-" + cleanPhone?substring(6,10) />
        <#else>
            <#return phone />
        </#if>
    <#else>
        <#return "" />
    </#if>
</#function>

<div style="position:relative; width:100%; font-family:Arial, sans-serif;">
  <!-- Logo positioned on the left -->
  <img src="https://11251501.app.netsuite.com/core/media/media.nl?id=10431&amp;c=11251501&amp;h=wQdV0jKlRF19fHZz9ovPNBrGRIuO5BepOvF1j7jGl1Vwt9yR" 
       alt="Thermoco Logo" style="position:absolute;  z-index:10; height: 140px; width: 758px;"/>
  
  <!-- SOUMISSION title -->
  <div style=" position:absolute; top: 5px; left: 315px; font-size:30px; font-weight:bold;">
    <b style="color: #6d6b6f;">SOUMISSION</b>
  </div>
  
  <!-- Subtext details floated -->
  <table style="table-layout:fixed; width:390px; position:absolute; left:190px; top:75px; border-collapse:collapse; font-family:Arial, sans-serif;">
    <tr>
      <td style="width:278px;font-size:11px; color:#333; padding:2px 0; white-space:nowrap; overflow:visible;">
        <b><i>La référence en chauffage et climatisation depuis 1981</i></b> 
      </td>
      <td style="width:60px;"></td>
      <td align="left" style="white-space:nowrap; overflow:visible; padding-left:-3px; width:105px;">
      <span  style="font-size:13px; color:#c4121a;">Thermoco.ca</span>
      </td>
    </tr>
    <tr style="line-height:4;padding-left:5px;">
     <td style="white-space:nowrap; overflow:visible; font-size:10px;  color:#333; padding:2px 0;">
        160, boul. Sir-Wilfrid-Laurier 100, <b>Beloeil</b> (Québec)
      </td>
     <td align="right" style="white-space:nowrap; overflow:visible;font-size:10px;  color:#333; padding:2px 0;">
        J3G 4Z7
      </td>
      <td  align="right" style="font-size:10px;  color:#333; padding:2px 0; padding-right:10px;">
        <strong>450 464-2188</strong>
      </td>

    </tr>
    <tr style="line-height:4;">
      <td style="white-space:nowrap; overflow:visible;font-size:10px; color:#333; padding:2px 0;">
        3305, avenue Broadway, bureau 103, <b>Brossard</b> (Québec)
      </td>
      <td align="right"  style="white-space:nowrap; overflow:visible; font-size:10px; color:#333; padding:2px 0;">
        J4Z 0N2
      </td>
      <td align="right" style="font-size:10px;   color:#333; padding:2px 0; padding-right:10px;">
        <strong>450 286-0226</strong>
      </td>
    </tr>
  </table>
</div>

 <img src="https://11251501.app.netsuite.com/core/media/media.nl?id=10430&amp;c=11251501&amp;h=z4DlU3ZhMnPO6Z6uqMZ3q2_05ayXUL5mAOhka9E0l5uVW-9f" 
           alt="CMMTQ Logo" style="position:absolute; top:75px; left:575px; vertical-align:middle; height: 22px; width: 54px; margin-right:5px;"/>

<!-- Bottom row with CMMTQ and RBQ -->
<table style="position:absolute; left:575px; top:75px; border-collapse:collapse; table-layout:fixed; width:200px;">
  <tr style="height:20px;">
    <td align="right" style="font-size:11px; padding-top:5px; padding-right:15px; width:85px;">
    <b> 6777</b>
    </td>
    <td align="left" style=" font-size:10px; padding-top:5px; padding-left:-5px; width:85px;">
     <b style="font-size:11px;"> RBQ:</b> <b> 1843-6162-60</b>
    </td>
  </tr>
  <tr>
    <td align="justify" style="text-align:left; font-size:10px; padding:5px 0;">
      Corporation des maîtres mécaniciens en tuyauterie du Québec (CMMTQ)
    </td>
    <td align="justify" style="text-align:right; font-size:10px; padding:2px 0;">
    Régie du bâtiment du Québec (RBQ)
    </td>
  </tr>
  
</table>
        </macro>
        <macro id="nlfooter">
            <table class="footer" style="width: 100%; height: 150px; padding-top:20px; font-size:8pt;">
                <tr>
                    <td align="center" style="width:80%; vertical-align:top;">
                        Un acompte de 15 % est exigé à la signature. Le solde est payable à la fin de l’installation.<br/>
                        Permis municipaux et permis de rénovation. Lorsque requis, les permis municipaux demeurent à la charge du client.<br/>
                        Éligibilité aux programmes. Le client est responsable de vérifier son admissibilité aux programmes, subventions.  <br/>
                        Thermoco n’assume aucune responsabilité en cas de refus ou de modification de ces programmes.
                    </td>
                </tr>
            </table>
        </macro>
    </macrolist>
    <style>
		* {
		<#if .locale == "zh_CN">
			font-family: NotoSans, NotoSansCJKsc, sans-serif;
		<#elseif .locale == "zh_TW">
			font-family: NotoSans, NotoSansCJKtc, sans-serif;
		<#elseif .locale == "ja_JP">
			fonstyt-family: NotoSans, NotoSansCJKjp, sans-serif;
		<#elseif .locale == "ko_KR">
			font-family: NotoSans, NotoSansCJKkr, sans-serif;
		<#elseif .locale == "th_TH">
			font-family: NotoSans, NotoSansThai, sans-serif;
		<#else>
			font-family: NotoSans, sans-serif;
		</#if>
		}
        table {
            font-size: 9pt;
            table-layout: fixed;
        }
        th {
            font-weight: bold;
            font-size: 8pt;
            vertical-align: middle;
            padding: 5px 6px 3px;
            background-color: #e3e3e3;
            color: #333333;
        }
        td {
            padding: 4px 6px;
        }
		td p { align:left }
        b {
            font-weight: bold;
            color: #333333;
        }
        table.header td {
            padding: 0;
            font-size: 10pt;
        }
        table.footer td {
            padding: 0;
            font-size: 8pt;
        }
        table.itemtable th {
            padding-bottom: 10px;
            padding-top: 10px;
        }
        table.body td {
            padding-top: 2px;
        }
        table.total {
            page-break-inside: avoid;
        }
        tr.totalrow {
            background-color: #e3e3e3;
            line-height: 200%;
        }
        td.totalboxtop {
            font-size: 12pt;
            background-color: #e3e3e3;
        }
        td.addressheader {
            font-size: 8pt;
            padding-top: 6px;
            padding-bottom: 2px;
        }
        td.address {
            padding-top: 0;
        }
        td.totalboxmid {
            font-size: 28pt;
            padding-top: 20px;
            background-color: #e3e3e3;
        }
        td.totalboxbot {
            background-color: #e3e3e3;
            font-weight: bold;
        }
        span.title {
            font-size: 28pt;
        }
        span.number {
            font-size: 16pt;
        }
        span.itemname {
            font-weight: bold;
            line-height: 150%;
        }
        hr {
            width: 100%;
            color: #d3d3d3;
            background-color: #d3d3d3;
            height: 1px;
        }
    </style>
</head>
<body header="nlheader" header-height="15%" footer="nlfooter" footer-height="75px" padding="0in 0in 0in 0in" size="Letter">
    
    <!-- Bill To and Ship To Section -->
    <table style="width: 100%; margin-top: 10px; border-collapse:collapse;">
        <tr>
            <td style="width:50%; vertical-align:top; padding-right:10px;">
                <div style="font-size:10pt; font-weight:bold; margin-bottom:5px; padding-bottom:3px;">
                   <b> Facturé à:</b>
                </div>
                <div style="font-size:9pt;">
                    <strong>${record.entity}</strong><br/>
                    <#if record.billaddr1?has_content>${record.billaddr1} </#if><#if record.billaddr2?has_content>${record.billaddr2} </#if><#if record.billaddr3?has_content>${record.billaddr3} </#if><#if record.billcity?has_content>${record.billcity}, </#if><#if record.billstate?has_content>${record.billstate} </#if><#if record.billzip?has_content>${record.billzip} </#if><#if record.billcountry?has_content>${record.billcountry}</#if><#if record.billaddr1?has_content || record.billcity?has_content><br/></#if>
                    <#if record.entity.phone?has_content>
                    Tél: ${formatPhone(record.entity.phone)}<br/>
                    </#if>
                    <#if record.entity.email?has_content>
                    Courriel: ${record.entity.email}
                    </#if>
                </div>
            </td>
            <td style="width:50%; vertical-align:top; padding-left:10px;">
                <div style="font-size:10pt; font-weight:bold; margin-bottom:5px; padding-bottom:3px;">
                    <b>Adresse des travaux (chantier):</b>
                </div>
                <div style="font-size:9pt;">
                    <strong>${record.entity}</strong><br/>
                    <#if record.shipaddr1?has_content>${record.shipaddr1} </#if><#if record.shipaddr2?has_content>${record.shipaddr2} </#if><#if record.shipaddr3?has_content>${record.shipaddr3} </#if><#if record.shipcity?has_content>${record.shipcity}, </#if><#if record.shipstate?has_content>${record.shipstate} </#if><#if record.shipzip?has_content>${record.shipzip} </#if><#if record.shipcountry?has_content>${record.shipcountry}</#if><#if record.shipaddr1?has_content || record.shipcity?has_content><br/></#if>
                    <#if record.entity.phone?has_content>
                    Tél: ${formatPhone(record.entity.phone)}<br/>
                    </#if>
                    <#if record.entity.email?has_content>
                    Courriel: ${record.entity.email}
                    </#if>
                </div>
            </td>
        </tr>
    </table>




    <!-- Sales Rep and Date Information -->
    <table style=" border-top:3px solid;border-bottom:3px solid;width: 100%; margin-top: 10px; border-collapse:collapse; font-size:9pt;">
        <tr >
            <td style="border-right: 3px solid; text-align:left; padding:5px; width:20%;"><b>Représentant</b></td>
            <td style="border-right: 3px solid; text-align:left; padding:5px; width:15%;"><b>Cellulaire</b></td>
            <td style="border-right: 3px solid; text-align:left; padding:5px; width:25%;"><b>Courriel</b></td>
            <td style="border-right: 3px solid; text-align:left; padding:5px; width:20%;"><b>Date début soumission</b></td>
            <td style="text-align:left; padding:5px; width:20%;"><b>Date fin soumission</b></td>
        </tr>
        <tr>
            <td style="border-right: 3px solid;padding:5px;">${record.salesrep}</td>
            <td style="border-right: 3px solid;padding:5px;">
                <#if record.salesrep.mobilephone?has_content>
                ${formatPhone(record.salesrep.mobilephone)}
                <#else>
                ${formatPhone(record.salesrep.phone)}
                </#if>
            </td>
            <td style="border-right: 3px solid;padding:5px;">${record.salesrep.email}</td>
            <td style="border-right: 3px solid;padding:5px;">${record.expectedclosedate}</td>
            <td style="padding:5px;">${record.duedate}</td>
        </tr>
    </table>
    
    <#if record.item?has_content>
    <table class="itemtable" style=" width: 100%; margin-top: 10px;">
        <!-- start items -->
        <#list record.item as item>
         <#if item.custcol_esp_kitwarranty == false>
            <#if item_index==0>
                <thead style="border-top:3px solid;border-bottom:3px solid; background-color:#gray;">
                    <tr>
                        <th align="left" style="width:15%;"><b>Article</b></th>
                        <th align="left" style="width:40%;"><b>Description</b></th>
                        <th align="center" style="width:5%;"><b>Qté</b></th>
                        <th align="right" style="width:12%;"><b>Prix</b></th>
                        <th align="right" style="width:12%;"><b>Montant</b></th>
                    </tr>
                </thead>
                </#if>
                <tr>
                    <td><b>${item.displayname}</b></td>
                    <td>${item.description}</td>
                    <td align="center">${item.quantity}</td>
                    <td align="right">${item.rate}</td>
                    <td align="right">${item.amount}</td>
                </tr>
            </#if>
        </#list>
        <!-- end items -->
    </table>
    <hr />
    </#if>
    
    <!-- Totals Section -->
    <table class="total" style="width: 100%; margin-top: 10px;">
        <tr>
            <td colspan="4"></td>
            <td align="right" style="width:150px;"><b>Sous-total:</b></td>
            <td align="right">${record.subtotal}</td>
        </tr>
        <tr>
            <td colspan="4"></td>
            <td align="right"><b>TPS (GST/HST):</b></td>
            <td align="right">${record.taxtotal}</td>
        </tr>
        <tr>
            <td colspan="4"></td>
            <td align="right"><b>TVQ (PST):</b></td>
            <td align="right">${record.tax2total}</td>
        </tr>
        <tr>
            <td colspan="4"></td>
            <td align="right"><b>Montant non-taxable:</b></td>
            <td align="right"><b style="color:#c4121a;"><#if record.altshippingcost?has_content>${record.altshippingcost}<#else>$0.00</#if></b></td>
        </tr>
        <tr class="totalrow">
            <td background-color="#ffffff"  colspan="4"></td>
            <td background-color="#ffffff" style="font-size:14px;" align="right"><b>Balance dû:</b></td>
            <td background-color="#ffffff" style="font-size:14px;" align="right"><b>${record.total}</b></td>
        </tr>
    </table>
    
    <!-- Warranty Items Section - New Page -->

    <#assign hasWarranty = false />
    <#list record.item as item>
        <#if item.custcol_esp_kitwarranty?? && item.custcol_esp_kitwarranty == true>
            <#assign hasWarranty = true />
            <#break />
        </#if>
    </#list>
    
    <#if hasWarranty>
        <pbr/>
    <h2 style="text-align:center; margin-top:20px; color:#c4121a;">Liste des garanties</h2>
    
    <table class="itemtable" style="width: 100%; margin-top: 10px; ">
        <thead>
            <tr style="border-top:3px solid;border-bottom:3px solid;">

                <th align="left" style="width:15%;">Article</th>
                <th align="left" style="width:40%;">Description</th>
                <th align="center" style="width:5%;">Qté</th>
                <th align="right" style="width:12%;">Prix</th>
                <th align="right" style="width:12%;">Montant</th>
            </tr>
        </thead>
        <#list record.item as item>
            <#if item.custcol_esp_kitwarranty?? && item.custcol_esp_kitwarranty == true>
            <tr>

                <td><b>${item.displayname}</b></td>
                <td>${item.description}</td>
                <td align="center">${item.quantity}</td>
                <td align="right">${item.rate}</td>
                <td align="right">${item.amount}</td>
            </tr>
            </#if>
        </#list>
    </table>
    </#if>
    
</body>
</pdf>